{{page-title "Event Detail"}}

{{#if @model.error}}
  <div class="empty-state py-5">
    <i class="bi bi-exclamation-triangle" style="font-size:3rem;"></i>
    <h5 class="mt-3">Event Not Found</h5>
    <LinkTo @route="events" class="btn btn-outline-primary btn-sm">Back to Events</LinkTo>
  </div>
{{else}}
  <div class="mb-3">
    <LinkTo @route="events" class="btn btn-outline-secondary btn-sm">
      <i class="bi bi-arrow-left"></i> Back to Events
    </LinkTo>
  </div>

  {{!-- Event header --}}
  <div class="card mb-4">
    <div class="card-body">
      <div class="d-flex justify-content-between align-items-start flex-wrap gap-2">
        <div>
          <h4 class="fw-bold mb-1">{{@model.match.match_name}}</h4>
          <div class="d-flex flex-wrap gap-3 text-muted">
            <span><i class="bi bi-calendar3"></i> {{@model.match.match_date}}</span>
            <span><i class="bi bi-geo-alt-fill"></i> {{@model.match.district}} â€” {{@model.match.area}}</span>
            <span><i class="bi bi-building"></i> {{@model.match.organizer_name}}</span>
          </div>
        </div>
        <span class="status-badge {{if (eq @model.match.status 'Completed') 'completed' (if (eq @model.match.status 'Live') 'live' 'scheduled')}}">
          {{@model.match.status}}
        </span>
      </div>
    </div>
  </div>

  {{!-- Capacity stats --}}
  <div class="row g-3 mb-4">
    <div class="col-md-3 col-6">
      <div class="card stat-card accent">
        <div class="stat-value">{{@model.capacity.registeredPlayers}}</div>
        <div class="stat-label">Registered Players</div>
      </div>
    </div>
    <div class="col-md-3 col-6">
      <div class="card stat-card green">
        <div class="stat-value">{{@model.match.player_limit}}</div>
        <div class="stat-label">Player Limit</div>
      </div>
    </div>
    <div class="col-md-3 col-6">
      <div class="card stat-card blue">
        <div class="stat-value">{{@model.capacity.registeredBulls}}</div>
        <div class="stat-label">Registered Bulls</div>
      </div>
    </div>
    <div class="col-md-3 col-6">
      <div class="card stat-card saffron">
        <div class="stat-value">{{@model.match.bull_limit}}</div>
        <div class="stat-label">Bull Limit</div>
      </div>
    </div>
  </div>

  {{!-- Registered Players --}}
  {{#if @model.playerRegistrations.length}}
    <div class="card mb-4">
      <div class="card-body">
        <h6 class="fw-bold mb-3"><i class="bi bi-person-arms-up text-primary"></i> Registered Players ({{@model.playerRegistrations.length}})</h6>
        <div class="table-responsive">
          <table class="table table-sm table-hover align-middle mb-0">
            <thead class="table-light">
              <tr><th>Player</th><th>Round</th><th>Batch</th><th>Status</th></tr>
            </thead>
            <tbody>
              {{#each @model.playerRegistrations as |p|}}
                <tr>
                  <td class="fw-semibold">{{p.player_name}}</td>
                  <td><span class="badge bg-secondary">{{p.round_name}}</span></td>
                  <td>{{p.batch_name}}</td>
                  <td><span class="status-badge {{if (eq p.status 'approved') 'approved' 'pending'}}">{{p.status}}</span></td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  {{/if}}

  {{!-- Registered Bulls --}}
  {{#if @model.bullRegistrations.length}}
    <div class="card">
      <div class="card-body">
        <h6 class="fw-bold mb-3"><i class="bi bi-shield-fill text-danger"></i> Registered Bulls ({{@model.bullRegistrations.length}})</h6>
        <div class="table-responsive">
          <table class="table table-sm table-hover align-middle mb-0">
            <thead class="table-light">
              <tr><th>Bull</th><th>Owner</th><th>Breed</th><th>Round</th><th>Status</th></tr>
            </thead>
            <tbody>
              {{#each @model.bullRegistrations as |b|}}
                <tr>
                  <td class="fw-semibold">{{b.bull_name}}</td>
                  <td>{{b.owner_name}}</td>
                  <td>{{b.breed}}</td>
                  <td><span class="badge bg-secondary">{{b.round_name}}</span></td>
                  <td><span class="status-badge {{if (eq b.status 'approved') 'approved' 'pending'}}">{{b.status}}</span></td>
                </tr>
              {{/each}}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  {{/if}}
{{/if}}
